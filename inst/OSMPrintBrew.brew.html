	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />

  <script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>

	<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>



	<div id="OSMMapID"></div>


	<script>



		var geoJSONSet = theRgeneratedgeoJSON;
		var map;
		// set up the map
		map = new L.Map('map', scrollWheelZooom=false);
		var ajaxRequest;
		var plotlist;
		var plotlayers=[];

		var mapID="#OSMMapID";

		$(document).ready(function(){
			$('#map').height($(window).height()-20);
	  		$('#map').width($(window).width()-20);
			initmap();
		});

		$(window).resize(function(){
			$('#map').val('');
			$('#map').height($(window).height()-20);
	  		$('#map').width($(window).width()-20);
			
		});
		function initmap() {
			

			// create the tile layer with correct attribution
			var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
			var osmAttrib='Map data Â© OpenStreetMap contributors';
			var osm = new L.TileLayer(osmUrl, {minZoom: 0, maxZoom: 19, attribution: osmAttrib});		

			baseLayer = {
 				"Base": osm
 			}
			// start the map in South-East England
			map.setView(new L.LatLng(mapCenterLat, mapCenterLong), mapZoomLevel);
			map.addLayer(osm);	

			var layers={};
			$.each(geoJSONSet, function(i, item){
 				//add the geo points
 				switch(item.data.features[0].geometry.type){
 					case "Point":
		 				layers[item.layer]=L.geoJson(item.data, { 
	 						pointToLayer: function(feature, latlng){
								return L.circleMarker(latlng, {
								radius: feature.properties.size,
								fillColor: feature.properties.color,
								color: "#000",
								weight: 1,
								opacity: 1,
								fillOpacity: 0.8
								}).bindPopup(feature.properties.popupContent);		
							}		
		 					});
		 			break;
		 			case "LineString": 
		 				layers[item.layer]=L.geoJson(item.data, { 
	 						onEachFeature: function(feature, layer){
								return L.polyline(feature.geometry.coordinates, {
								color: feature.properties.color
							});	
		 					}		
		 				});			
		 			break;	
		 		}	
 			});
			//add the layers to the map
			layerControl = 	L.control.layers(baseLayer, layers, {
 				collapsed: false
 			});
 			layerControl.addTo(map);
 			$.each(layers, function(i, item){
  				map.addLayer(item);
  			});
 			L.control.scale().addTo(map);
			
		}

	</script>